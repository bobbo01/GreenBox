<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" th:href="@{/resetcss/reset.css}"></link>
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

<style type="text/css">

/* 폰트 */
@font-face {
	font-family: 'NPSfontBold';
	src:
		url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2310@1.0/NPSfontBold.woff2')
		format('woff2');
	font-weight: 700;
	font-style: normal;
}

@font-face {
	font-family: 'NanumSquareNeo-Variable';
	src:
		url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_11-01@1.0/NanumSquareNeo-Variable.woff2')
		format('woff2');
	font-weight: normal;
	font-style: normal;
}

/* 아이콘 */
.material-symbols-outlined {
	font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24
}

body {
	margin: 0 16.2vw;
	font-family: '나눔고딕', sans-serif;
}

.adminCate {
	padding: 15px 13px 15px 20px;
	border: 1px solid rgb(242, 242, 242);
	display: flex;
	align-items: center;
	justify-content: space-between;
	min-width: 200px;
	font-family: 'NanumSquareNeo-Variable';
}

/* 메인 */
.adminBox {
	min-width: 880px;
	font-family: '나눔고딕', sans-serif;
}

.admin_container {
	display: grid;
	grid-template-columns: 1fr 5fr;
	min-height: 650px;
}

.adminBtnList {
	background-color: #32B43A;
	color: white;
	border-radius: 20px;
}

#adminPa {
	font-family: 'NPSfontBold';
	margin-top: 30px;
	height: 75px;
	padding: 5px 0px 35px 1px;
	font-size: 28px;
	line-height: 35px;
	color: rgb(51, 51, 51);
	letter-spacing: -1px;
}

.list {
	cursor: pointer;
	font-family: 'NPSfontBold';
	text-decoration: none;
	color: white;
}

.admin_total {
	width: 200px;
	height: 500px;
}

.main {
	min-height: 500px;
} /* 왼쪽 카테고리 끝 */

/* adminItem css 시작*/
/*메인*/
.adminBox {
	display: flex;
	margin: 0 auto;
	min-width: 620px;
	padding: 30px 10px;
}

.adminBtnList {
	background-color: #32B43A;
	color: white;
	border-radius: 20px;
}

#adminPa {
	margin-top: 30px;
	height: 75px;
	padding: 5px 0px 35px 1px;
	font-size: 28px;
	line-height: 35px;
	color: rgb(51, 51, 51);
	letter-spacing: -1px;
}

.adminContent_1 {
	margin-left: 1%;
	width: 100%;
	height: 100%;
	min-width: 500px;
	/* border: 1px solid #32B43A; */
	border-radius: 10px;
}
/* 타이틀 */
.adminMemberTitle {
	text-align: center;
	font-size: 2em;
	margin-bottom: 2%;
	font-family: 'NPSfontBold';
}

/* 등록, 검색 */
.itemTop {
	display: flex;
	justify-content: space-between;
}
/* 등록 */
.adminItemRegister_total {
	margin-bottom: 2%;
	margin-left: 3%;
}
/* 검색 */
.adminSec_total {
	text-align: right;
	margin-bottom: 2%;
	margin-right: 3%;
}

/* 검색 input */
.searchInput {
	width: 150px;
	line-height: 20px;
	border: 1px solid #ddd;
	border-radius: 3px;
	text-indent: 5px;
	color: #666;
	font-family: 'NanumSquareNeo-Variable';
}

/* 등록, 검색 버튼 */
.itemBtn, .searchSubmit {
	width: 50px;
	background-color: #ddd;
	border: transparent;
	border-radius: 3px;
	line-height: 20px;
	font-family: 'NanumSquareNeo-Variable';
	cursor: pointer;
	filter: brightness(1);
}

.itemBtn:hover, .searchSubmit:hover {
	filter: brightness(0.9);
	transition: filter 1s;
}

/* table */
.adminMemberBoard {
	margin: auto;
	width: 95%;
	border-collapse: collapse;
	font-family: 'NanumSquareNeo-Variable';
	min-width: 720px;
}

.adminMemberBoard tr:first-child {
	background-color: #32B43A;
	color: white;
}

.adminMemberBoard tr {
	background-color: white;
	border-bottom: 1px solid #ddd;
}

.adminMemberBoard th, .adminMemberBoard td {
	padding: 1em 1em;
	text-align: center;
}

.adminMemberBoard td {
	vertical-align: middle;
	font-size: 13px;
}
/*사진*/
.itemImg {
	width: 80px;
	height: 80px;
}

/* 페이징 */
.adminMember_page_wrap {
	margin-top: 2%;
	margin-bottom: 2%;
	text-align: center;
	font-size: 0;
}

.adminMember_page {
	display: inline-block;
}

.adminMember_page .none {
	display: none;
}

.adminMember_page a {
	display: block;
	margin: 0 3px;
	float: left;
	border: 1px solid #e6e6e6;
	width: 28px;
	height: 28px;
	line-height: 28px;
	text-align: center;
	background-color: #fff;
	font-size: 13px;
	color: #999999;
	text-decoration: none;
}

.adminMember_page .arrow {
	border: 1px solid #ccc;
}

.adminMember_page .prev {
	background: #f8f8f8 no-repeat center center;
	margin-right: 7px;
}

.adminMember_page .next {
	background: #f8f8f8 no-repeat center center;
	margin-left: 7px;
}

.adminMember_page a.active {
	background-color: #42454c;
	color: #fff;
	border: 1px solid #42454c;
}
/* adminItem css 끝*/
</style>
</head>
<header th:replace="hf/header"></header>

<body>
	<section>
		<div class="adminBox">

			<div class="admin_container">

				<div class="admin_total">
					<div id="adminPa">
						<h1>관리자</h1>
					</div>
					<div class="adminBtnList">
						<ul>
							<li class="adminCate"><span
								class="material-symbols-outlined">add_chart</span> <a
								class="list" href="/admin/">매출조회</a> <span
								class="material-symbols-outlined">chevron_right</span></li>

							<li class="adminCate"><span
								class="material-symbols-outlined">group</span> <a class="list"
								href="/admin/adminCustomer">회원조회</a> <span
								class="material-symbols-outlined">chevron_right</span></li>

							<li class="adminCate"><span
								class="material-symbols-outlined">support_agent</span> <a
								class="list" href="/admin/adminAsk">1:1문의</a> <span
								class="material-symbols-outlined">chevron_right</span></li>
							<li class="adminCate"><span
								class="material-symbols-outlined">settings</span> <a
								class="list" href="/admin/adminBoard">게시관리</a> <span
								class="material-symbols-outlined">chevron_right</span></li>
							<li class="adminCate"><span
								class="material-symbols-outlined">package_2</span> <a
								class="list" href="/admin/adminItem">상품관리</a> <span
								class="material-symbols-outlined">chevron_right</span></li>

							<li class="adminCate"><span
								class="material-symbols-outlined">price_change</span> <a
								class="list" href="/admin/adminCoupon">쿠폰조회</a> <span
								class="material-symbols-outlined">chevron_right</span></li>
								
							<li class="adminCate"><span
								class="material-symbols-outlined">fact_check</span>
								<a class="list" href="/admin/adminQuitReason">탈퇴사유조회</a>
								<span class="material-symbols-outlined">chevron_right</span></li>	
						</ul>
					</div>
				</div>
				<div class="main">
					<!-- 메인시작 -->
					<div id="dynamic-content">
						<!-- adminItem 시작 -->
						<div class="adminBox">
							<!-- 내용 -->
							<div class="adminContent_1">
								<div class="adminMember">
									<div class="adminMemberTitle">
										<h1>상품관리</h1>
									</div>
									<!-- 등록 / 검색 -->
									<div class="itemTop">
										<!-- 등록/검색 전체 div-->
										<div class="adminItemRegister_total">
											<button name="itemRegister" class="itemBtn"
												th:onclick="'window.location.href=\'' + @{/admin/adminItemRegister} + '\''">등록</button>
										</div>
										<div class="adminSec_total">
											<form action="/admin/adminItem">
												<div class="adminSec">
													<input type="text" class="searchInput" placeholder="상품명 검색"
														name="search" size="10">
													<button type="submit" class="searchSubmit">검색</button>
												</div>
											</form>
										</div>
									</div>
									<!-- 등록/검색 전체 div 끝 -->
									<!-- 상품 리스트 -->
									<div>
										<div class="adminMemberList">
											<table class="adminMemberBoard">
												<tbody class="adminMember_boardList">
													<tr class="adminMemberContent">
														<th class="adminMember_head">상품명</th>
														<th class="adminMember_head">가격</th>
														<th class="adminMember_head">중량</th>
														<th class="adminMember_head">카테고리</th>
														<th class="adminMember_head">이미지</th>
														<th class="adminMember_head">수량</th>
														<th class="adminMember_head">상태변경</th>
													</tr>
													<tr th:if="${productList.empty}" class="adminMemberContent">
														<td class="adminMemberContent_a" colspan="7">등록된 상품이
															없습니다.</td>
													</tr>
													<tr th:each="product : ${productList}"
														class="adminMemberContent">
														<td class="adminMemberContent_a"
															th:text="${product.productName}"></td>
														<td class="adminMemberContent_a"
															th:text="${product.price} + '원'"></td>
														<td class="adminMemberContent_a"
															th:text="${product.weight}"></td>
														<td class="adminMemberContent_a"
															th:text="${product.category}"></td>
														<td class="adminMemberContent_a"><img class="itemImg"
															th:src="@{${product.imageURL}}" alt="사진"></td>
														<td class="adminMemberContent_a"
															th:text="${product.count}"></td>
														<td class="adminMemberContent_a">
															<button name="itemModify" class="itemBtn"
																th:data-product-id="${product.productID}"
																onclick="itemModify(this)">수정</button> <br> <br>
															<button name="itemDel" class="itemBtn"
																th:data-product-id="${product.productID}"
																onclick="itemDelete(this)">삭제</button>
														</td>
													</tr>
												</tbody>
											</table>

										</div>
										<!-- 페이징 버튼 -->
										<div class="adminMember_page_wrap"
											th:if="${!productList.empty}">
											<div class="adminMember_page">
												<!-- 이전 페이지 버튼 -->
												<a th:if="${productList.hasPrevious()}"
													th:href="@{/admin/adminItem(page=${productList.number - 1}, search=${search})}"
													class="arrow prev"> ◀ </a>
												<!-- 페이지 번호 -->
												<span
													th:each="pageNum : ${#numbers.sequence(1, productList.totalPages)}">
													<a
													th:href="@{/admin/adminItem(page=${pageNum - 1}, search=${search})}"
													th:class="${pageNum} == ${productList.number + 1} ? 'active' : ''"
													th:text="${pageNum}">1</a>
												</span>
												<!-- 다음 페이지 버튼 -->
												<a th:if="${productList.hasNext()}"
													th:href="@{/admin/adminItem(page=${productList.number + 1}, search=${search})}"
													class="arrow next"> ▶ </a>
											</div>
										</div>

									</div>
									<!-- 회원 리스트 끝-->

								</div>
								<!-- adminMember 끝 -->
							</div>
							<!-- admin_total 끝 -->
						</div>
						<!-- adminBox 끝 -->
						<!-- adminItem 끝-->
					</div>
				</div>
				<!-- 메인끝 -->
			</div>
		</div>
	</section>
</body>

<footer th:replace="hf/footer"></footer>

<script>
	function itemModify(element) {
		var productId = element.getAttribute('data-product-id'); // 버튼의 data-product-id 속성 값 가져오기
		window.location.href = '/admin/adminItemModify?productId=' + productId; // 상품 수정 페이지로 리다이렉트
	}

	function itemDelete(element) {
		var productId = element.getAttribute('data-product-id'); // 버튼의 data-product-id 속성 값 가져오기

		if (confirm("해당 상품의 정보를 삭제하시겠습니까?")) {
		    fetch('/admin/adminItemDelete', {
		        method: 'POST',
		        headers: {
		            'Content-Type': 'text/plain'
		        },
		        body: productId
		    })
		    .then(response => {
		        if (response.ok) {
		            alert('삭제가 완료되었습니다');
		            window.location.href = '/admin/adminItem';
		        } else {
		            throw new Error('삭제에 실패하였습니다.');
		        }
		    })
		    .catch(error => alert(error.message));
		}


	}
</script>


</html>